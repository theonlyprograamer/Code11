<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Checkout - TechStore</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <h1>Checkout</h1>
  <div class="cart-items" id="cartDisplay"></div>

  <form id="checkoutForm" action="https://formsubmit.co/theinvestorcompany001@gmail.com" method="POST" onsubmit="showThanks()">
    <input type="text" name="name" placeholder="Your Name" required />
    <input type="email" name="email" placeholder="Your Email" required />
    <input type="text" name="phone" placeholder="Phone Number" required />
    <textarea name="address" placeholder="Delivery Address" required></textarea>
    <input type="hidden" name="cart" id="cartInput" />
    <input type="hidden" name="_captcha" value="false" />
    <button type="submit">Submit Order</button>
  </form>

  <script>
    const cartDisplay = document.getElementById("cartDisplay");
    const cartInput = document.getElementById("cartInput");
    const params = new URLSearchParams(window.location.search);
    const cartData = params.get("cart");
    let cart = cartData ? JSON.parse(decodeURIComponent(cartData)) : {};

    function updateCartUI() {
      let displayText = "<strong>Items in your cart:</strong><br><br>";
      let cartSummary = "";
      let total = 0;

      for (let item in cart) {
        const { quantity, price } = cart[item];
        total += quantity * price;
        displayText += `
          <p>
            ${item} - $${price} × 
            <button type="button" onclick="updateQuantity('${item}', -1)">−</button>
            ${quantity}
            <button type="button" onclick="updateQuantity('${item}', 1)">+</button>
            = <strong>$${quantity * price}</strong>
          </p>`;
        cartSummary += `${item}: ${quantity} x $${price} = $${quantity * price}\n`;
      }

      displayText += `<p><strong>Total: $${total}</strong></p>`;
      cartDisplay.innerHTML = displayText;
      cartInput.value = cartSummary + `\nTotal: $${total}`;
    }

    function updateQuantity(item, change) {
      if (cart[item]) {
        cart[item].quantity += change;
        if (cart[item].quantity <= 0) delete cart[item];
        updateCartUI();
      }
    }

    function showThanks() {
      setTimeout(() => {
        alert("Thank you for shopping with us!");
      }, 100);
    }

    updateCartUI();
  </script>
</body>
</html>